<div class="reset-password-container">
  <div class="reset-password-card">
    <div class="card-header">
      <h2>ğŸ” Nouveau mot de passe</h2>
      <p>CrÃ©ez un nouveau mot de passe sÃ©curisÃ©</p>
    </div>

    <!-- Token Validation Loading -->
    <div *ngIf="validatingToken" class="validation-loading">
      <div class="spinner-large"></div>
      <p>VÃ©rification du lien...</p>
    </div>

    <!-- Invalid Token -->
    <div *ngIf="!validatingToken && !tokenValid" class="alert alert-error">
      <div class="alert-icon">âŒ</div>
      <div>
        <strong>Lien invalide</strong>
        <p>{{ error }}</p>
        <button (click)="goToLogin()" class="btn-secondary">
          Retour Ã  la connexion
        </button>
      </div>
    </div>

    <!-- Success Message -->
    <div *ngIf="success" class="alert alert-success">
      <div class="alert-icon">âœ…</div>
      <div>
        <strong>Mot de passe modifiÃ© !</strong>
        <p>Votre mot de passe a Ã©tÃ© modifiÃ© avec succÃ¨s.</p>
        <p>Redirection vers la page de connexion...</p>
      </div>
    </div>

    <!-- Error Message -->
    <div *ngIf="error && !success && tokenValid" class="alert alert-error">
      <div class="alert-icon">âŒ</div>
      <div>
        <strong>Erreur</strong>
        <p>{{ error }}</p>
      </div>
    </div>

    <!-- Reset Password Form -->
    <form *ngIf="tokenValid && !success && !validatingToken" (ngSubmit)="onSubmit()" class="reset-password-form">
      <div class="form-group">
        <label for="newPassword">
          <span class="icon">ğŸ”’</span>
          Nouveau mot de passe
        </label>
        <div class="password-input-wrapper">
          <input
            [type]="showPassword ? 'text' : 'password'"
            id="newPassword"
            [(ngModel)]="newPassword"
            name="newPassword"
            placeholder="Entrez votre nouveau mot de passe"
            [disabled]="loading"
            required
            minlength="6"
          />
          <button
            type="button"
            class="toggle-password"
            (click)="togglePasswordVisibility()"
            [disabled]="loading"
          >
            {{ showPassword ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
          </button>
        </div>
        <small class="help-text">Minimum 6 caractÃ¨res</small>
      </div>

      <div class="form-group">
        <label for="confirmPassword">
          <span class="icon">ğŸ”’</span>
          Confirmer le mot de passe
        </label>
        <div class="password-input-wrapper">
          <input
            [type]="showConfirmPassword ? 'text' : 'password'"
            id="confirmPassword"
            [(ngModel)]="confirmPassword"
            name="confirmPassword"
            placeholder="Confirmez votre mot de passe"
            [disabled]="loading"
            required
            minlength="6"
          />
          <button
            type="button"
            class="toggle-password"
            (click)="toggleConfirmPasswordVisibility()"
            [disabled]="loading"
          >
            {{ showConfirmPassword ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
          </button>
        </div>
      </div>

      <button type="submit" class="btn-submit" [disabled]="loading">
        <span *ngIf="!loading">RÃ©initialiser le mot de passe</span>
        <span *ngIf="loading" class="loading">
          <span class="spinner"></span>
          RÃ©initialisation...
        </span>
      </button>

      <div class="back-to-login">
        <a routerLink="/login" class="link">
          â† Retour Ã  la connexion
        </a>
      </div>
    </form>
  </div>
</div>
